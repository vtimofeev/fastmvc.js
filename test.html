<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>

    <style>
        .test {
            background-color: #EFCFFF;
            border: 1px #000000 dashed;
        }

        .item
        {
            list-style: none;
            background-color: #EFBBDD;

        }
    </style>

    <script src="js/underscore.js"></script>
    <script src="js/jquery-1.10.2.js"></script>
    <script src="js/basis-template-1.0.js"></script>

</head>

<body>
<div id="content"></div>
Form
<div id="form-content"></div>

<script type="text/basis-template" id='form-template'>
<div>
    <form>
        {nameValid} <input{inputName} name="name" value="{name}" placeholder="Name" event-keydown="key"/>
        {emailValid} <input{inputEmail} name="email" value="{email}" placeholder="Name" />
        <button event-click="validate">Submit</button>
    </form>
</div>
</script>

<a href="#" onclick="addBindedElement(container, data); return false;">add</a>
<a href="#" onclick="change(); return false;">update</a>

<script>

    var btform = bt('id:form-template');
    function onForm(name, event){
        alert(name);// + ',' + event.name + ', ' + event.target + ', ' + event.target.container +  '!');

    }

    var cform = btform.createInstance(null, onForm);
    var cform2 = btform.createInstance(null, onForm);

    var dataInput = {name:'', email:'', nameValid:'start', emailValid:'start', test: 'test1', eventname: 'key-123'};

    cform.inputName.container = cform;
    cform.inputName.dataset({test: 1});
    alert(cform.inputName.dataset(test))
    cform2.inputName.container = cform2;

    _.forEach(dataInput , function(v,k) {cform.set(k,v); });
    _.forEach(dataInput , function(v,k) {cform2.set(k,v); });

    cform.inputName.value = 123;
    //cform.test.value = 123;
    //cform.get('test').value = 123;

    formContainer = document.getElementById('form-content');
    formContainer.appendChild(cform.element);
    formContainer.appendChild(cform2.element);

    //cform.test.value = 123123123;




    var items = [];



    var data = {data:123, nodes: []};
    var container = document.getElementById('content');

    function change()
    {
        'use strict';
        //const test = 1;
        //test = 2;

        data.data = Math.random();

        for (var i in data.nodes)
        {

            data.nodes[i].nodeValue = data.data;
        }
    }

    function addBindedElement(container, object)
    {
        //const test = 1;
        //test = 2;


        var div = document.createElement('div');
        var div1 = document.createElement('div');
        var div2 = document.createElement('div');
        div1.innerHTML = 'any text';
        div2.innerHTML = 'any text 222';
        var text = document.createTextNode(object.data);
        object.nodes.push(text);

        div.appendChild(text);
        div.appendChild(div1);
        div.appendChild(div2);
        container.appendChild(div);
    }

    /*
    var time = (new Date()).getTime();
    var size = 2000;
    function diffTime(m) {
        var result = (new Date()).getTime() - time;
        console.log('Diff ' + m + ', ' + result);
        time = new Date().getTime();
        return;
    }

    function getContent(value) {
        return '<div class="test" style="width:' + 100 + 'px;height:' + Math.round(Math.random()*100 + 100) + 'px;background-color:#EFEFEF;border: 1px; margin-left: 10px; margin-top: 10px;"><ul>' + '<li class="item">' + value + '</li>' + '<li class="item">' + value + '</li>' + '<li class="item">' + value + '</li>' + '</ul></div>';
    }

    $ct = $('#content');

    for (var i = 0; i < size; i++) {
        var content = getContent(i);
        $ct.append("<div id='div" + i + "'>" + content + "</div>");
    }

    diffTime('Create');

    for (var i = 0; i < size; i++) {
        var content = getContent(i);
        $('#div' + i).html(content);
    }

    diffTime('Update');


    for (var i = 0; i < size; i++) {
        var content = getContent(i);
        $('#div' + i).html(content);
    }

    diffTime('Update');
    */


</script>

</body>
</html>