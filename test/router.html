<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Router</title>
</head>
<body>
<a href="/category/1001/page/2002/">/category/1001/page/2002/</a>
<a href="/category/1001/page/2002/overlay/3003/">/category/1001/page/2002/overlay/3003/</a>
<a href="/page/2002/overlay/3003/">/page/2002/overlay/3003/</a>

<script src="../src/contrib/grapnel.js"></script>
<script>
    function addRoute(routes, name) {
        routes['*/' + name + '/:data/*'] = function(req, e) {
            var path = req.match[0],
                matches = path.match( new RegExp('.*\/' + name + '\/([^\/]+)\/.*') ),
                value = matches && matches[1];

            console.log(name, 'found', value);
            req.overlay = value;
        }
    }

    var routes = {
        '/*' : function(req, e){
            console.log('?overlay', req.overlay);
        }
/*

        '*!/page/:data/!*' : function(req, e){
        },
        '*!/overlay/:data/!*' : function(req, e){
           console.log('Overlay', req);
        },
*/

    };

    addRoute(routes, 'overlay');



    var g = Grapnel.listen({ pushState : true }, ro                                 1`utes);

    g.get(/.*\/overlay\/([^\/]+)\//, function dec(req, e){
        console.log('1overlay', req,  req.overlay);
    });

    g.get(/.*/, function abc(req, e){
        console.log('final', req);
    });

    g.navigate('/category/1000/page/2000/overlay/3000/#abcdef');



    ([].slice.call(document.getElementsByTagName('a')))
            .forEach( function(v) {
                console.log(v);
                v.addEventListener('click', function (e) {
                    console.log('---------------------------------')
                    e.preventDefault();
                    g.navigate(e.target.getAttribute('href'));
                })
            });
</script>


</body>
</html>